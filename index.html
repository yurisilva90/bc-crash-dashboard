<!DOCTYPE html>
<html lang="pt-BR">
  <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>BC Crash Dashboard v6</title>
      <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
      <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body {
                              background: linear-gradient(135deg, #0f1419 0%, #1a1f2e 100%);
                              color: #e0e0e0;
                              font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                              padding: 20px;
                }
                .container { max-width: 1400px; margin: 0 auto; }
                .tabs { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #2a3142; }
                .tab-btn {
                              padding: 12px 24px;
                              background: transparent;
                              color: #888;
                              border: none;
                              cursor: pointer;
                              font-size: 14px;
                              font-weight: 500;
                              border-bottom: 3px solid transparent;
                              transition: all 0.3s;
                }
                .tab-btn.active {
                              color: #00ff88;
                              border-bottom-color: #00ff88;
                }
                .tab-btn:hover { color: #00ff88; }
                .tab-content { display: none; }
                .tab-content.active { display: block; }

                .header {
                              display: flex;
                              justify-content: space-between;
                              align-items: center;
                              margin-bottom: 20px;
                              padding: 15px;
                              background: rgba(42, 49, 66, 0.5);
                              border-radius: 8px;
                              border-left: 4px solid #00ff88;
                }
                .status { display: flex; gap: 20px; align-items: center; }
                .status-item { display: flex; align-items: center; gap: 8px; }
                .status-indicator {
                              width: 12px;
                              height: 12px;
                              border-radius: 50%;
                              background: #00ff88;
                }
                .status-indicator.error { background: #ff4444; }

                .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
                .card {
                              background: rgba(42, 49, 66, 0.6);
                              border: 1px solid rgba(0, 255, 136, 0.2);
                              border-radius: 8px;
                              padding: 20px;
                              backdrop-filter: blur(10px);
                }
                .card-title { font-size: 12px; color: #888; text-transform: uppercase; margin-bottom: 10px; }
                .card-value { font-size: 24px; font-weight: bold; color: #00ff88; }
                .card-value.negative { color: #ff4444; }
                .card-value.neutral { color: #fff; }

                .chart-container { position: relative; height: 350px; margin-top: 15px; }
                .chart-controls {
                              display: flex;
                              gap: 10px;
                              margin-bottom: 10px;
                              flex-wrap: wrap;
                }
                .chart-btn {
                              padding: 8px 12px;
                              background: rgba(0, 255, 136, 0.1);
                              border: 1px solid rgba(0, 255, 136, 0.3);
                              color: #00ff88;
                              border-radius: 4px;
                              cursor: pointer;
                              font-size: 12px;
                              transition: all 0.3s;
                }
                .chart-btn:hover { background: rgba(0, 255, 136, 0.2); }
                .chart-btn.active { background: rgba(0, 255, 136, 0.3); border-color: #00ff88; }

                .simulator-section { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
                .form-group {
                              display: flex;
                              flex-direction: column;
                              gap: 8px;
                              margin-bottom: 15px;
                }
                .form-group label {
                              font-size: 12px;
                              color: #888;
                              text-transform: uppercase;
                              font-weight: 500;
                }
                .form-group input {
                              padding: 10px 12px;
                              background: rgba(0, 0, 0, 0.3);
                              border: 1px solid rgba(0, 255, 136, 0.2);
                              border-radius: 4px;
                              color: #e0e0e0;
                              font-size: 14px;
                }
                .form-group input:focus {
                              outline: none;
                              border-color: #00ff88;
                              background: rgba(0, 0, 0, 0.5);
                }
                .button-group {
                              display: flex;
                              gap: 10px;
                              margin-top: 20px;
                }
                .btn {
                              flex: 1;
                              padding: 12px;
                              border: none;
                              border-radius: 4px;
                              cursor: pointer;
                              font-weight: 600;
                              font-size: 14px;
                              transition: all 0.3s;
                }
                .btn-primary {
                              background: linear-gradient(135deg, #00ff88 0%, #00cc66 100%);
                              color: #000;
                }
                .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 16px rgba(0, 255, 136, 0.3); }
                .btn-secondary {
                              background: rgba(0, 255, 136, 0.1);
                              color: #00ff88;
                              border: 1px solid rgba(0, 255, 136, 0.3);
                }
                .btn-secondary:hover { background: rgba(0, 255, 136, 0.2); }

                .results-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
                .result-item {
                              background: rgba(0, 0, 0, 0.3);
                              padding: 15px;
                              border-radius: 4px;
                              border-left: 3px solid #00ff88;
                }
                .result-label { font-size: 12px; color: #888; }
                .result-value { font-size: 18px; font-weight: bold; color: #00ff88; margin-top: 5px; }
                .result-value.negative { color: #ff4444; }
                .max-available { font-size: 11px; color: #666; margin-top: 5px; }

                @media (max-width: 1024px) {
                              .grid { grid-template-columns: 1fr; }
                              .simulator-section { grid-template-columns: 1fr; }
                              .results-grid { grid-template-columns: 1fr; }
                }
            </style>
  </head>
  <body>
        <div class="container">
                  <div class="header">
                                <div>
                                                  <h1 style="margin-bottom: 5px;">üéÆ BC CRASH DASHBOARD</h1>h1>
                                                  <p style="font-size: 12px; color: #888;">v6 - An√°lise em tempo real com Supabase</p>p>
                                </div>
                                <div class="status">
                                                  <div class="status-item">
                                                                        <div class="status-indicator" id="supabaseStatus"></div>
                                                                        <span id="statusText">Conectando...</span>span>
                                                  </div>
                                                  <div class="status-item">
                                                                        <span id="totalRounds">TOTAL: 0</span>span>
                                                  </div>
                                </div>
                  </div>

                  <div class="tabs">
                                <button class="tab-btn active" onclick="switchTab('dashboard')">üìä Dashboard</button>button>
                                <button class="tab-btn" onclick="switchTab('simulator')">üé∞ Simulador</button>button>
                                <button class="tab-btn" onclick="switchTab('analyse')">üìà An√°lise</button>button>
                  </div>

                  <div id="dashboard" class="tab-content active">
                                <div class="grid">
                                                  <div class="card">
                                                                        <div class="card-title">Maior Multiplicador</div>
                                                                        <div class="card-value" id="maxMult">0x</div>
                                                  </div>
                                                  <div class="card">
                                                                        <div class="card-title">M√©dia Multiplicador</div>
                                                                        <div class="card-value" id="avgMult">0x</div>
                                                  </div>
                                                  <div class="card">
                                                                        <div class="card-title">Mediana Multiplicador</div>
                                                                        <div class="card-value" id="medianMult">0x</div>
                                                  </div>
                                                  <div class="card">
                                                                        <div class="card-title">% Maior que 2x</div>
                                                                        <div class="card-value" id="percentGt2">0%</div>
                                                  </div>
                                </div>

                                <div class="card">
                                                  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                                                        <div class="card-title">Distribui√ß√£o</div>
                                                                        <div class="chart-controls">
                                                                                                  <button class="chart-btn active" onclick="setDistributionRange('all')">Todos</button>button>
                                                                                                  <button class="chart-btn" onclick="setDistributionRange('100')">100x+</button>button>
                                                                                                  <button class="chart-btn" onclick="setDistributionRange('50')">50-100x</button>button>
                                                                        </div>
                                                  </div>
                                                  <div class="chart-container">
                                                                        <canvas id="distributionChart"></canvas>canvas>
                                                  </div>
                                </div>

                                <div class="card">
                                                  <div class="card-title">Ocorr√™ncias por Range</div>
                                                  <div class="chart-container">
                                                                        <canvas id="rangesChart"></canvas>canvas>
                                                  </div>
                                </div>

                                <div class="card">
                                                  <div class="card-title">Timeline - √öltimas 200 Rodadas</div>
                                                  <div class="chart-container">
                                                                        <canvas id="timelineChart"></canvas>canvas>
                                                  </div>
                                </div>
                  </div>

                  <div id="simulator" class="tab-content">
                                <div class="simulator-section">
                                                  <div class="card">
                                                                        <h3 style="margin-bottom: 20px; color: #00ff88;">‚öôÔ∏è Configurar Simula√ß√£o</h3>h3>

                                                                        <div class="form-group">
                                                                                                  <label>ENTRADA (R$)</label>
                                                                                                <input type="number" id="entrada" value="1" min="0.01" step="0.01">
                                                                        </div>
                                                                      
                                                                      <div class="form-group">
                                                                                              <label>MULTIPLICADOR DE SA√çDA</label>
                                                                                              <input type="number" id="payout" value="20" min="1" step="0.1">
                                                                      </div>
                                                                      
                                                                      <div class="form-group">
                                                                                              <label>MULTIPLICADOR AP√ìS PERDA</label>
                                                                                              <input type="number" id="multLoss" value="1.05265" min="1" step="0.00001">
                                                                      </div>
                                                                      
                                                                      <div class="form-group">
                                                                                              <label>MULTIPLICADOR AP√ìS CICLO PERDIDO</label>
                                                                                              <input type="number" id="multCycleLoss" value="2" min="1" step="0.1">
                                                                      </div>
                                                                      
                                                                      <div class="form-group">
                                                                                              <label>QTD DE CICLOS DE RECUPERA√á√ÉO</label>
                                                                                              <input type="number" id="recoveryCount" value="3" min="1" step="1">
                                                                      </div>
                                                                      
                                                                      <div class="form-group">
                                                                                              <label>MULTIPLICADOR DA ENTRADA NO CICLO DE RECUPERA√á√ÉO</label>
                                                                                              <input type="number" id="recoveryMult" value="2" min="1" step="0.1">
                                                                      </div>
                                                                      
                                                                      <div class="form-group">
                                                                                              <label>QTD DE PERDAS CONSECUTIVAS POR CICLO</label>
                                                                                              <input type="number" id="maxLosses" value="61" min="1" step="1">
                                                                      </div>
                                                                      
                                                                      <div class="form-group">
                                                                                              <label>VALOR M√ÅXIMO DE APOSTA</label>
                                                                                              <input type="number" id="maxBet" value="4007" min="1" step="1">
                                                                      </div>
                                                                      
                                                                      <div class="form-group">
                                                                                              <label>N√öMERO DE RODADAS A SIMULAR</label>
                                                                                              <input type="number" id="numRounds" value="100" min="1" step="1">
                                                                                              <div class="max-available" id="maxAvailable">M√°ximo dispon√≠vel: 0 rodadas</div>
                                                                      </div>
                                                                      
                                                                      <div class="button-group">
                                                                                              <button class="btn btn-primary" onclick="runSimulation()">‚ñ∂ Executar Simula√ß√£o</button>button>
                                                                                              <button class="btn btn-secondary" onclick="resetSimulation()">‚Üª Resetar</button>button>
                                                                      </div>
                                                  </div>
                                
                                                <div class="card">
                                                                    <h3 style="margin-bottom: 20px; color: #00ff88;">üìä Resultados</h3>h3>
                                                                    
                                                                    <div class="results-grid">
                                                                                            <div class="result-item">
                                                                                                                        <div class="result-label">Saldo Final</div>
                                                                                                                        <div class="result-value" id="resultFinalBalance">R$ 0.00</div>
                                                                                              </div>
                                                                                            <div class="result-item">
                                                                                                                        <div class="result-label">Vit√≥rias / Derrotas</div>
                                                                                                                        <div class="result-value" id="resultWinLoss">0 / 0</div>
                                                                                              </div>
                                                                                            <div class="result-item">
                                                                                                                        <div class="result-label">Taxa de Vit√≥ria</div>
                                                                                                                        <div class="result-value" id="resultWinRate">0%</div>
                                                                                              </div>
                                                                                            <div class="result-item">
                                                                                                                        <div class="result-label">ROI</div>
                                                                                                                        <div class="result-value" id="resultROI">0%</div>
                                                                                              </div>
                                                                                            <div class="result-item">
                                                                                                                        <div class="result-label">Lucro L√≠quido</div>
                                                                                                                        <div class="result-value" id="resultProfit">R$ 0.00</div>
                                                                                              </div>
                                                                                            <div class="result-item">
                                                                                                                        <div class="result-label">Drawdown M√°ximo</div>
                                                                                                                        <div class="result-value negative" id="resultDrawdown">R$ 0.00</div>
                                                                                              </div>
                                                                                            <div class="result-item">
                                                                                                                        <div class="result-label">Maior Aposta</div>
                                                                                                                        <div class="result-value" id="resultMaxBet">R$ 0.00</div>
                                                                                              </div>
                                                                                            <div class="result-item">
                                                                                                                        <div class="result-label">Rodadas Simuladas</div>
                                                                                                                        <div class="result-value neutral" id="resultRounds">0</div>
                                                                                              </div>
                                                                    </div>
                                                                    
                                                                    <div style="margin-top: 20px; height: 300px;">
                                                                                            <canvas id="balanceChart"></canvas>canvas>
                                                                    </div>
                                                
                                                                    <div style="margin-top: 20px; height: 300px;">
                                                                                            <canvas id="profitChart"></canvas>canvas>
                                                                    </div>
                                                </div>
                                </div>
                  </div>
        
                <div id="analyse" class="tab-content">
                            <div class="card">
                                            <div class="card-title">Informa√ß√µes do Banco de Dados</div>
                                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-top: 15px;">
                                                                <div>
                                                                                        <div style="color: #888; font-size: 12px;">Total de Rodadas</div>
                                                                                        <div style="font-size: 20px; color: #00ff88; font-weight: bold;" id="analyseTotal">0</div>
                                                                </div>
                                                                <div>
                                                                                        <div style="color: #888; font-size: 12px;">Maior Multiplicador</div>
                                                                                        <div style="font-size: 20px; color: #00ff88; font-weight: bold;" id="analyseMax">0x</div>
                                                                </div>
                                                                <div>
                                                                                        <div style="color: #888; font-size: 12px;">M√©dia</div>
                                                                                        <div style="font-size: 20px; color: #00ff88; font-weight: bold;" id="analyseAvg">0x</div>
                                                                </div>
                                                                <div>
                                                                                        <div style="color: #888; font-size: 12px;">Mediana</div>
                                                                                        <div style="font-size: 20px; color: #00ff88; font-weight: bold;" id="analyseMedian">0x</div>
                                                                </div>
                                            </div>
                            </div>
                </div>
        </div>
  
      <script>
                const SUPABASE_URL = 'https://eopbtokkxtyloyfdjypl.supabase.co';
                const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVvcGJ0b2treHR5bG95ZmRqeXBsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjI5MTc5MDcsImV4cCI6MjAzODQ5Mzk0N30.ViRLLq97zPZLuFJOCQdplRPJALI8JlbWL7cFQq1Oc2g';

                let allData = [];
                let charts = {};
                let currentDistributionRange = 'all';

                function switchTab(tab) {
                              document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
                              document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
                              document.getElementById(tab).classList.add('active');
                              event.target.classList.add('active');
                              setTimeout(() => { Object.values(charts).forEach(chart => chart?.resize?.()); }, 100);
                }

                function setDistributionRange(range) {
                              currentDistributionRange = range;
                    document.querySelectorAll('.chart-controls .chart-btn').forEach((btn, idx) => {
                                      btn.classList.toggle('active', 
                                                                               (range === 'all' && idx === 0) ||
                                                                               (range === '100' && idx === 1) ||
                                                                               (range === '50' && idx === 2)
                                                                           );
                    });
                              updateDistributionChart(range);
                }

                async function fetchData() {
                              try {
                                                const response = await fetch(
                                                                      `${SUPABASE_URL}/rest/v1/crash_rounds?select=*&order=captured_at.desc&limit=500`,
                                                  {
                                                                            headers: {
                                                                                                          'apikey': SUPABASE_KEY,
                                                                                                          'Authorization': `Bearer ${SUPABASE_KEY}`,
                                                                                                          'Content-Type': 'application/json'
                                                                              }
                                                  }
                                                                  );

                                                if (response.ok) {
                                                                      allData = await response.json();
                                                                      allData.reverse();
                                                                      updateDashboard();
                                                                      updateAnalyse();
                                                                      document.getElementById('supabaseStatus').classList.remove('error');
                                                                      document.getElementById('statusText').textContent = 'Conectado ‚úì';
                                                } else {
                                                                      throw new Error('Erro na resposta');
                                                }
                              } catch (error) {
                                                console.error('Erro:', error);
                                                document.getElementById('supabaseStatus').classList.add('error');
                                                document.getElementById('statusText').textContent = 'Desconectado ‚úó';
                              }
                }

                function updateDashboard() {
                              document.getElementById('totalRounds').textContent = `TOTAL: ${allData.length}`;

                              if (allData.length === 0) return;

                              const multipliers = allData.map(r => parseFloat(r.multiplier));
                              const maxMult = Math.max(...multipliers);
                              const avgMult = (multipliers.reduce((a, b) => a + b) / multipliers.length).toFixed(2);
                              const sorted = [...multipliers].sort((a, b) => a - b);
                              const medianMult = sorted[Math.floor(sorted.length / 2)].toFixed(2);
                              const percentGt2 = ((multipliers.filter(m => m >= 2).length / multipliers.length) * 100).toFixed(1);

                              document.getElementById('maxMult').textContent = `${maxMult.toFixed(2)}x`;
                              document.getElementById('avgMult').textContent = `${avgMult}x`;
                              document.getElementById('medianMult').textContent = `${medianMult}x`;
                              document.getElementById('percentGt2').textContent = `${percentGt2}%`;

                              updateDistributionChart(currentDistributionRange);
                              updateRangesChart();
                              updateTimelineChart();
                }

                function updateDistributionChart(range) {
                              if (allData.length === 0) return;

                              let multipliers = allData.map(r => parseFloat(r.multiplier));

                              if (range === '100') multipliers = multipliers.filter(m => m >= 100);
                              else if (range === '50') multipliers = multipliers.filter(m => m >= 50 && m < 100);

                              const bins = [1, 2, 5, 10, 20, 50, 100, 200, 500];
                              const counts = Array(bins.length - 1).fill(0);

                              multipliers.forEach(m => {
                                                for (let i = 0; i < bins.length - 1; i++) {
                                                                      if (m >= bins[i] && m < bins[i + 1]) {
                                                                                                counts[i]++;
                                                                                                break;
                                                                      }
                                                }
                              });

                              const ctx = document.getElementById('distributionChart').getContext('2d');
                              if (charts.distribution) charts.distribution.destroy();

                    charts.distribution = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: bins.slice(0, -1).map((b, i) => `${b}x-${bins[i + 1]}x`),
                                                    datasets: [{
                                label: 'Frequ√™ncia',
                                                                              data: counts,
                                                                              backgroundColor: '#00ff88',
                                                                              borderColor: '#00cc66',
                                                                              borderWidth: 1
                                                    }]
        },
                                      options: {
                                                            responsive: true,
                                                            maintainAspectRatio: false,
                                                            plugins: { legend: { display: false } },
                                                            scales: {
                                                                                      y: { beginAtZero: true, ticks: { color: '#888' }, grid: { color: 'rgba(255,255,255,0.05)' } },
                                                                                      x: { ticks: { color: '#888' }, grid: { display: false } }
                                                              }
                                      }
                    });
                }

                function updateRangesChart() {
                              if (allData.length === 0) return;

                              const multipliers = allData.map(r => parseFloat(r.multiplier));
                              const ranges = {
                                                '‚â•20x': multipliers.filter(m => m >= 20).length,
                                                '‚â•30x': multipliers.filter(m => m >= 30).length,
                                                '‚â•50x': multipliers.filter(m => m >= 50).length,
                                                '‚â•100x': multipliers.filter(m => m >= 100).length,
                                                '‚â•200x': multipliers.filter(m => m >= 200).length
                              };

                              const ctx = document.getElementById('rangesChart').getContext('2d');
                              if (charts.ranges) charts.ranges.destroy();

                              charts.ranges = new Chart(ctx, {
                                                type: 'doughnut',
                                                data: {
                                                                      labels: Object.keys(ranges),
                                                                      datasets: [{
                                                                                                data: Object.values(ranges),
                                                                                                backgroundColor: ['#ff9800', '#ffc107', '#4caf50', '#2196f3', '#9c27b0']
                                                                        }]
                                                },
                                                options: {
                                                                      responsive: true,
                                                                      maintainAspectRatio: false,
                                                                      plugins: {
                                                                                                legend: { labels: { color: '#888', padding: 20 } }
                                                                      }
                                                }
                              });
                }

                function updateTimelineChart() {
                              const multipliers = allData.slice(-200).map(r => parseFloat(r.multiplier));
                              const ctx = document.getElementById('timelineChart').getContext('2d');
                              if (charts.timeline) charts.timeline.destroy();

                              charts.timeline = new Chart(ctx, {
                                                type: 'line',
                                                data: {
                                                                      labels: multipliers.map((_, i) => i + 1),
                                                                      datasets: [{
                                                                                                label: 'Multiplicador',
                                                                                                data: multipliers,
                                                                                                borderColor: '#00ff88',
                                                                                                backgroundColor: 'rgba(0, 255, 136, 0.1)',
                                                                                                fill: true,
                                                                                                tension: 0.3,
                                                                                                pointRadius: 0
                                                                        }]
                                                },
                                                options: {
                                                                      responsive: true,
                                                                      maintainAspectRatio: false,
                                                                      plugins: { legend: { labels: { color: '#888' } } },
                                                                      scales: {
                                                                                                y: { beginAtZero: true, ticks: { color: '#888' }, grid: { color: 'rgba(255,255,255,0.05)' } },
                                                                                                x: { ticks: { color: '#888' }, grid: { display: false } }
                                                                        }
                                                }
                              });
                }

                function runSimulation() {
                              const entrada = parseFloat(document.getElementById('entrada').value);
                              const payout = parseFloat(document.getElementById('payout').value);
                              const multLoss = parseFloat(document.getElementById('multLoss').value);
                              const multCycleLoss = parseFloat(document.getElementById('multCycleLoss').value);
                              const recoveryCount = parseInt(document.getElementById('recoveryCount').value);
                              const recoveryMult = parseFloat(document.getElementById('recoveryMult').value);
                              const maxLosses = parseInt(document.getElementById('maxLosses').value);
                              const maxBet = parseFloat(document.getElementById('maxBet').value);
                              const numRounds = Math.min(parseInt(document.getElementById('numRounds').value), allData.length);

                              if (numRounds > allData.length) {
                                                alert(`M√°ximo dispon√≠vel: ${allData.length} rodadas`);
                                                return;
                              }

                              const rounds = allData.slice(0, numRounds);
                              let balance = 0;
                              let wins = 0;
                              let losses = 0;
                              let currentBet = entrada;
                              let consecutiveLosses = 0;
                              let recoveryMode = false;
                              let recoveryRound = 0;
                              let maxDrawdown = 0;
                              let maxBetUsed = 0;
                              let totalBetted = 0;
                              let peakBalance = 0;

                              const balanceHistory = [0];
                              const profitHistory = [0];

                              rounds.forEach(round => {
                                                const multiplier = parseFloat(round.multiplier);
                                                currentBet = Math.min(currentBet, maxBet);
                                                maxBetUsed = Math.max(maxBetUsed, currentBet);
                                                totalBetted += currentBet;

                                                if (multiplier >= payout) {
                                                                      // VIT√ìRIA - Ganha baseado na apostaCROSSOVER DO MULTIPLICADOR
                                                                      const profit = currentBet * (multiplier - 1);
                                                                      balance += profit;
                                                                      wins++;
                                                                      consecutiveLosses = 0;
                                                                      currentBet = entrada;
                                                                      recoveryMode = false;
                                                                      recoveryRound = 0;
                                                } else {
                                                                      // PERDA - Perde a aposta inteira
                                                                      balance -= currentBet;
                                                                      losses++;
                                                                      consecutiveLosses++;

                                                                      if (consecutiveLosses >= maxLosses) {
                                                                                                recoveryMode = true;
                                                                                                recoveryRound = 0;
                                                                                                currentBet = entrada * recoveryMult;
                                                                                                consecutiveLosses = 0;
                                                                      } else {
                                                                                                currentBet = currentBet * multLoss;
                                                                      }
                                                }

                                                if (recoveryMode) {
                                                                      recoveryRound++;
                                                                      if (recoveryRound >= recoveryCount) {
                                                                                                recoveryMode = false;
                                                                                                recoveryRound = 0;
                                                                                                currentBet = entrada;
                                                                      }
                                                }

                                                balanceHistory.push(balance);
                                                peakBalance = Math.max(peakBalance, balance);
                                                maxDrawdown = Math.min(maxDrawdown, balance - peakBalance);
                                                profitHistory.push(balance);
                              });

                              // Atualizar resultados
                              const finalBalance = balance;
                              const roi = totalBetted > 0 ? ((balance / totalBetted) * 100) : 0;

                              document.getElementById('resultFinalBalance').textContent = `R$ ${finalBalance.toFixed(2)}`;
                              document.getElementById('resultFinalBalance').classList.toggle('negative', finalBalance < 0);

                              document.getElementById('resultWinLoss').textContent = `${wins} / ${losses}`;
                    document.getElementById('resultWinRate').textContent = `${((wins / numRounds) * 100).toFixed(1)}%`;
                    document.getElementById('resultROI').textContent = `${roi.toFixed(2)}%`;
                              document.getElementById('resultProfit').textContent = `R$ ${finalBalance.toFixed(2)}`;
                    document.getElementById('resultProfit').classList.toggle('negative', finalBalance < 0);
                              document.getElementById('resultDrawdown').textContent = `R$ ${maxDrawdown.toFixed(2)}`;
                              document.getElementById('resultMaxBet').textContent = `R$ ${maxBetUsed.toFixed(2)}`;
                              document.getElementById('resultRounds').textContent = numRounds;

                              updateBalanceChart(balanceHistory);
                              updateProfitChart(profitHistory);
                }

                function updateBalanceChart(balanceHistory) {
                              const ctx = document.getElementById('balanceChart').getContext('2d');
                              if (charts.balance) charts.balance.destroy();

                              charts.balance = new Chart(ctx, {
                                                type: 'line',
                                                data: {
                                                                      labels: balanceHistory.map((_, i) => i),
                                                                      datasets: [{
                                                                                                label: 'Evolu√ß√£o da Banca (R$)',
                                                                                                data: balanceHistory,
                                                                                                borderColor: '#00ff88',
                                                                                                backgroundColor: 'rgba(0, 255, 136, 0.1)',
                                                                                                fill: true,
                                                                                                tension: 0.3,
                                                                                                pointRadius: 0,
                                                                                                borderWidth: 2
                                                                        }]
                                                },
                                                options: {
                                                                      responsive: true,
                                                                      maintainAspectRatio: false,
                                                                      plugins: { legend: { labels: { color: '#888' } } },
                                                                      scales: {
                                                                                                y: { ticks: { color: '#888' }, grid: { color: 'rgba(255,255,255,0.05)' } },
                                                                                                x: { ticks: { color: '#888' }, grid: { display: false } }
                                                                        }
                                                }
                              });
                }

                function updateProfitChart(profitHistory) {
                              const ctx = document.getElementById('profitChart').getContext('2d');
                              if (charts.profit) charts.profit.destroy();

                              charts.profit = new Chart(ctx, {
                                                type: 'line',
                                                data: {
                                                                      labels: profitHistory.map((_, i) => i),
                                                                      datasets: [{
                                                                                                label: 'Lucro/Preju√≠zo Acumulado (R$)',
                                                                                                data: profitHistory,
                                                                                                borderColor: '#ff9800',
                                                        backgroundColor: 'rgba(255, 152, 0, 0.1)',
                                                                                                fill: true,
                                                                                                tension: 0.3,
                                                                                                pointRadius: 0,
                                                                                                borderWidth: 2
                                                                        }]
                                                },
                                                options: {
                                                                      responsive: true,
                                                                      maintainAspectRatio: false,
                                                                      plugins: { legend: { labels: { color: '#888' } } },
                                                                      scales: {
                                                                                                y: { ticks: { color: '#888' }, grid: { color: 'rgba(255,255,255,0.05)' } },
                                                                                                x: { ticks: { color: '#888' }, grid: { display: false } }
                                                                        }
                                                }
                              });
                }

                function resetSimulation() {
                              Object.keys(charts).forEach(key => {
                                                if (charts[key]) charts[key].destroy();
                              });
                              document.getElementById('resultFinalBalance').textContent = 'R$ 0.00';
                              document.getElementById('resultWinLoss').textContent = '0 / 0';
                              document.getElementById('resultWinRate').textContent = '0%';
                              document.getElementById('resultROI').textContent = '0%';
                              document.getElementById('resultProfit').textContent = 'R$ 0.00';
                              document.getElementById('resultDrawdown').textContent = 'R$ 0.00';
                              document.getElementById('resultMaxBet').textContent = 'R$ 0.00';
                              document.getElementById('resultRounds').textContent = '0';
                }

                function updateAnalyse() {
                              if (allData.length === 0) return;

                              const multipliers = allData.map(r => parseFloat(r.multiplier));
                              const maxMult = Math.max(...multipliers);
                              const avgMult = (multipliers.reduce((a, b) => a + b) / multipliers.length).toFixed(2);
                              const sorted = [...multipliers].sort((a, b) => a - b);
                              const medianMult = sorted[Math.floor(sorted.length / 2)].toFixed(2);

                              document.getElementById('analyseTotal').textContent = allData.length;
                              document.getElementById('analyseMax').textContent = `${maxMult.toFixed(2)}x`;
                              document.getElementById('analyseAvg').textContent = `${avgMult}x`;
                              document.getElementById('analyseMedian').textContent = `${medianMult}x`;
                }

                fetchData();
                setInterval(fetchData, 30000);

                setInterval(() => {
                              document.getElementById('maxAvailable').textContent = `M√°ximo dispon√≠vel: ${allData.length} rodadas`;
                }, 1000);
      </script>
  </body>
</html>html>
      </script></label></label>
                                </div>
  </body>
      </style></title>
  </head>
